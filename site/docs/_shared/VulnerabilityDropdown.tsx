import React, { useState } from 'react';
import SecurityPluginsTable from './SecurityPluginsTable';
import PrivacyPluginsTable from './PrivacyPluginsTable';
import CriminalPluginsTable from './CriminalPluginsTable';
import HarmfulPluginsTable from './HarmfulPluginsTable';
import MisinformationPluginsTable from './MisinformationPluginsTable';

const VulnerabilityDropdown = () => {
  const [openSections, setOpenSections] = useState<Set<string>>(new Set(['security']));

  const toggleSection = (section: string) => {
    setOpenSections(prev => {
      const newSections = new Set(prev);
      if (newSections.has(section)) {
        newSections.delete(section);
      } else {
        newSections.add(section);
      }
      return newSections;
    });
  };

  const renderSection = (
    title: string, 
    id: string, 
    description: string,
    Table: React.ComponentType
  ) => (
    <div key={id}>
      <h3 
        onClick={() => toggleSection(id)}
        style={{ cursor: 'pointer' }}
      >
        {title} {openSections.has(id) ? '▼' : '▶'}
      </h3>
      <p>{description}</p>
      {openSections.has(id) && <Table />}
    </div>
  );

  const sections = [
    {
      title: 'Security Vulnerabilities',
      id: 'security',
      description: 'Technical security risks including injection attacks, broken access control, and prompt leaks.',
      component: SecurityPluginsTable
    },
    {
      title: 'Privacy Violations',
      id: 'privacy',
      description: 'Risks related to personal data exposure and privacy breaches.',
      component: PrivacyPluginsTable
    },
    {
      title: 'Criminal Activities',
      id: 'criminal',
      description: 'Content related to illegal activities and criminal behavior.',
      component: CriminalPluginsTable
    },
    {
      title: 'Harmful Content',
      id: 'harmful',
      description: 'Content that could cause harm or distress to users.',
      component: HarmfulPluginsTable
    },
    {
      title: 'Misinformation and Misuse',
      id: 'misinformation',
      description: 'False information, hallucinations, and model misuse.',
      component: MisinformationPluginsTable
    }
  ];

  return (
    <div>
      {sections.map(section => 
        renderSection(
          section.title,
          section.id,
          section.description,
          section.component
        )
      )}
    </div>
  );
};

export default VulnerabilityDropdown; 